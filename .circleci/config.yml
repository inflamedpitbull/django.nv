orbs:
    queue: eddiewebb/queue@volatile
jobs:
    - publish:   
        filters:
        branches:
            only: master
    build:
    docker:
        - image: python:3.6                   # similar to "image" in GitLab
    steps:
        - checkout
        - run: |                              # similar to "script" in GitLab
            pip install -r requirements.txt
            python manage.py check

    test:
    docker:
        - image: python:3.6
    steps:
        - checkout
        - run: |
            pip install -r requirements.txt
            python manage.py test taskManager

    integration:
    docker:
        - image: python:3.6
    steps:
        - checkout
        - run:
            shell: /bin/sh
            command: |
            echo "This is an integration step"
            exit 1

    prod:
    docker:
        - image: python:3.6
    steps:
        - checkout
        - run: echo "This is a deploy step"


    artifacts:
    docker:
        - image: python:3.6   
    steps:
        - run:
            name: Creating Artifacts
            command: |
            echo "hello" > hello.txt        
        - store_artifacts:
            path: hello.txt
            destination: artifact-file

    workflows:
    version: 2
    django:
    jobs:
        - build
        - test
        - integration
        - prod
